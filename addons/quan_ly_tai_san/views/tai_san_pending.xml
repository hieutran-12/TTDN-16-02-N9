<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Tree view cho danh sách tài sản chờ tạo -->
    <record id="view_tai_san_pending_tree" model="ir.ui.view">
        <field name="name">hoa.don.mua.pending.tree</field>
        <field name="model">hoa_don_mua</field>
        <field name="arch" type="xml">
            <tree string="Tài sản chờ tạo" create="false" edit="false">
                <field name="name" string="Số HĐ"/>
                <field name="ngay_hoa_don" string="Ngày HĐ"/>
                <field name="nha_cung_cap_id"/>
                <field name="tong_thanh_toan" widget="monetary"/>
                <field name="state" string="Trạng thái HĐ"/>
                <field name="asset_status" string="Trạng thái TS"/>
            </tree>
        </field>
    </record>
    
    <!-- Form view chi tiết cho tài sản chờ tạo -->
    <record id="view_tai_san_pending_form" model="ir.ui.view">
        <field name="name">hoa.don.mua.pending.form</field>
        <field name="model">hoa_don_mua</field>
        <field name="arch" type="xml">
            <form string="Hóa đơn chờ tạo tài sản">
                <header>
                    <button name="action_tao_tai_san" type="object" string="✨ Tạo tài sản" 
                            class="btn-primary" attrs="{'invisible': [('asset_status', '!=', 'pending')]}"/>
                </header>
                <sheet>
                    <group>
                        <group>
                            <field name="name" readonly="1"/>
                            <field name="ngay_hoa_don" readonly="1"/>
                            <field name="nha_cung_cap_id" readonly="1"/>
                        </group>
                        <group>
                            <field name="tong_tien" readonly="1" widget="monetary"/>
                            <field name="tien_thue" readonly="1" widget="monetary"/>
                            <field name="tong_thanh_toan" readonly="1" widget="monetary"/>
                        </group>
                    </group>
                    <group>
                        <field name="co_tai_san" readonly="1"/>
                        <field name="asset_status" readonly="1"/>
                        <field name="ma_tai_san_created" readonly="1" attrs="{'invisible': [('asset_status', '!=', 'created')]}"/>
                    </group>
                </sheet>
            </form>
        </field>
    </record>
    
    <!-- Action để hiển thị tài sản chờ tạo từ hóa đơn -->
    <record id="action_tai_san_pending" model="ir.actions.act_window">
        <field name="name">Tài sản chờ tạo</field>
        <field name="res_model">hoa_don_mua</field>
        <field name="view_mode">tree,form</field>
        <field name="view_ids" eval="[(5, 0, 0), (0, 0, {'view_mode': 'tree', 'view_id': ref('view_tai_san_pending_tree')}), (0, 0, {'view_mode': 'form', 'view_id': ref('view_tai_san_pending_form')})]"/>
        <field name="domain">[('co_tai_san', '=', True), ('asset_status', '=', 'pending')]</field>
        <field name="help">Danh sách hóa đơn chờ tạo tài sản. Nhấn nút "Tạo tài sản" để tạo tài sản từ hóa đơn.</field>
    </record>
    
    <!-- Menu item -->
    <menuitem id="menu_tai_san_pending" 
              name="Tài sản chờ tạo" 
              parent="menu_root"
              action="action_tai_san_pending"
              sequence="5"/>
</odoo>
